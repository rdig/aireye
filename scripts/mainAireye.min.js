window.addEventListener("load",function(){interfaceDisplay.setUtcClock("timeDisplay");interfaceDisplay.showHideHeader("headerControl");try{ae.drawMap();setInterval(function(){ae.drawAirplanes()},2000)}catch(a){console.log("Sorry but an error occured: "+a+" .I'm afraid you are on your own. Good luck.")}},false);window.addEventListener("resize",function(){var a=ae.getTrackerCoordinates();ae.gMap.setCenter({lat:a.latitude,lng:a.longitude})},false);var ae={gMap:null,airplanesMarkers:{},getTrackerCoordinates:function(){return gen.fetchJSONData("tracker.json")},getLocalAirports:function(){return gen.fetchJSONData("local-airports.json")},getMapOptions:function(a){return{backgroundColor:"#010101",center:new google.maps.LatLng(a.latitude,a.longitude),zoom:11,maxZoom:15,minZoom:8,mapTypeControl:false,streetViewControl:false,zoomControl:false,panControl:false,}},getAirplanesData:function(c){c=c||false;if(c){var d=gen.fetchJSONData("test-data.json")}else{var d=gen.fetchJSONData("getCorsJSON.php","functions/")}var b={};for(var a=0;a<d.length;a+=1){if(d[a]["hex"]!=="undefined"){b[d[a]["hex"]]=d[a]}}return b},drawDistanceCircles:function(b,e,a){for(var c=10;c<=e*10;c+=10){var d=new google.maps.Circle({map:b,center:{lat:a.latitude,lng:a.longitude},radius:c*1852,fillOpacity:0,strokeWeight:1,strokeOpacity:0.2,strokeColor:"#2ECC71",})}},drawAirportHighlight:function(a,c){for(var b in c){var d=new google.maps.Circle({map:a,center:{lat:c[b].lat,lng:c[b].lon},radius:c[b].size*1000,strokeColor:"#FFFFFF",strokeOpacity:0,strokeWeight:0,fillColor:"#27AF5F",fillOpacity:0.1,})}},drawMap:function(){var b=new google.maps.StyledMapType([{stylers:[{hue:"#22ff00"},{saturation:-62},{visibility:"simplified"},{invert_lightness:true},{lightness:-64}]},{featureType:"administrative",stylers:[{visibility:"simplified"},{color:"#333333"}]},{featureType:"poi",stylers:[{visibility:"off"}]},{featureType:"road",stylers:[{visibility:"on"},{lightness:-50}]},{featureType:"transit",stylers:[{visibility:"off"}]},{featureType:"transit.station.airport",elementType:"geometry",stylers:[{visibility:"on"},{invert_lightness:true},{weight:8},{color:"#27AE60"}]},{featureType:"water",stylers:[{visibility:"off"}]}],{name:"Aireye Styled Map"}),a="ae_styled_map",c=this.getLocalAirports(),d=this.getTrackerCoordinates();this.gMap=new google.maps.Map(document.getElementById("googleMap"),this.getMapOptions(d));this.gMap.mapTypes.set(a,b);this.gMap.setMapTypeId(a);this.drawDistanceCircles(this.gMap,20,d);this.drawAirportHighlight(this.gMap,c)},updateMarkerIcon:function(d,c,b){var a=JSON.parse(JSON.stringify(d.icon));c=c||"fillColor";b=b||"#9B59B6";a[c]=b;d.setIcon(a)},drawSingleAirplane:function(b){var a={path:"M 9 0 L 11 0 L 11 10 L 15 10 L 15 20 L 5 20 L 5 10 L 9 10 L 9 12 L 7 12 L 7 18 L 13 18 L 13 12 L 11 12 L 11 14 L 9 14 Z",strokeWeight:0,fillColor:"#FFFFFF",fillOpacity:1,size:new google.maps.Size(20,20),origin:new google.maps.Point(0,0),anchor:new google.maps.Point(10,10),rotation:b.track},c=new google.maps.Marker({position:new google.maps.LatLng(b.lat,b.lon),icon:a,title:b.flight,airplaneDisplayData:{hex:b.hex,flight:b.flight,position:b.lat+", "+b.lon,squawk:b.squawk,altitude:b.altitude,track:b.track,speed:b.speed,isMarkerSelected:false},map:this.gMap});google.maps.event.addListener(c,"click",function(){if(this.airplaneDisplayData.isMarkerSelected){ae.updateMarkerIcon(this,"fillColor","#FFFFFF");this.airplaneDisplayData.isMarkerSelected=false;interfaceDisplay.hidePlaneData("planeData")}else{for(var d in ae.airplanesMarkers){ae.updateMarkerIcon(ae.airplanesMarkers[d],"fillColor","#FFFFFF");ae.airplanesMarkers[d].airplaneDisplayData.isMarkerSelected=false;interfaceDisplay.hidePlaneData("planeData")}ae.updateMarkerIcon(this,"fillColor","#08e008");this.airplaneDisplayData.isMarkerSelected=true;interfaceDisplay.updatePlaneData(this,"planeData");ae.gMap.setCenter({lat:b.lat,lng:b.lon})}});return c},updateAirplanesMarkers:function(a){if(this.airplanesMarkers.hasOwnProperty(a.hex)){if(a.seen>30){this.removeAirplaneMarker(this.airplanesMarkers[a.hex]);return true}else{if(a.validtrack===1){this.updateMarkerIcon(this.airplanesMarkers[a.hex],"rotation",a.track)}this.airplanesMarkers[a.hex].setPosition(new google.maps.LatLng(a.lat,a.lon));this.airplanesMarkers[a.hex].airplaneDisplayData.position=a.lat+", "+a.lon;this.airplanesMarkers[a.hex].airplaneDisplayData.squawk=a.squawk;this.airplanesMarkers[a.hex].airplaneDisplayData.altitude=a.altitude;this.airplanesMarkers[a.hex].airplaneDisplayData.track=a.track;this.airplanesMarkers[a.hex].airplaneDisplayData.speed=a.speed;if(this.airplanesMarkers[a.hex].airplaneDisplayData.isMarkerSelected){interfaceDisplay.updatePlaneData(this.airplanesMarkers[a.hex],"planeData");this.gMap.setCenter({lat:a.lat,lng:a.lon})}return true}}return false},removeAirplaneMarker:function(a){a.setMap(null);if(a.airplaneDisplayData.isMarkerSelected){interfaceDisplay.hidePlaneData("planeData")}delete this.airplanesMarkers[a.airplaneDisplayData.hex]},drawAirplanes:function(){var c=this.getAirplanesData(),a=function(d){if(d.validposition===0){return false}if(d.seen>30){return false}return true};if(Object.keys(this.airplanesMarkers).length<1){for(var b in c){if(a(c[b])){this.airplanesMarkers[b]=this.drawSingleAirplane(c[b])}}}else{for(var b in c){if(!this.updateAirplanesMarkers(c[b])){if(a(c[b])){this.airplanesMarkers[b]=this.drawSingleAirplane(c[b])}}}}interfaceDisplay.updateTrackedPlanes(Object.keys(this.airplanesMarkers).length,"trackedPlanes")}};var interfaceDisplay={setUtcClock:function(e,f){(f)?clearTimeout(f):null;var b=new Date(),d=b.getUTCHours(),a=b.getUTCMinutes(),c=b.getUTCSeconds();if(d<10){d="0"+d}if(a<10){a="0"+a}if(c<10){c="0"+c}document.getElementById(e).innerHTML=d+":"+a+"."+c;var f=setInterval(function(){interfaceDisplay.setUtcClock(e,f)},1000)},showHideHeader:function(a){var b=document.getElementById(a);b.addEventListener("click",function(){var c=this.childNodes[1].className;if(c.indexOf("open")>-1){document.getElementsByTagName("header")[0].style.marginLeft="100%";this.childNodes[1].className=c.replace(" open","")}else{document.getElementsByTagName("header")[0].style.marginLeft="0px";this.childNodes[1].className=c+" open"}})},updateTrackedPlanes:function(b,a){document.getElementById(a).innerHTML=parseInt(b,10)},setPlaneData:function(b){var a="<p>";a+="Flight: <span>"+b.flight+"</span>";a+="ICAO: <span>"+b.hex.toUpperCase()+"</span>";a+="Altitude: <span>"+b.altitude+" ft</span>";a+="Heading: <span>"+b.track+"&#176;</span>";a+="Lat / Lon: <span>"+b.position+"</span>";a+="Speed: <span>"+b.speed+" kt</span>";if(b.squawk!=="0000"){if(b.squawk==="7500"||b.squawk==="7600"||b.squawk==="7700"){a+='Squawk: <span class="warning">'+b.squawk+"</span>"}else{a+="Squawk: <span>"+b.squawk+"</span>"}}a+="</p>";return a},updatePlaneData:function(b,a){a=a||"planeData";var c=document.getElementById(a);c.innerHTML=this.setPlaneData(b.airplaneDisplayData);c.style.bottom="-150px";c.style.display="block";c.style.bottom=(-1*c.offsetHeight)+"px";c.style.bottom="0px"},hidePlaneData:function(a){a=a||"planeData";document.getElementById(a).style.bottom="-150px"}};var gen={fetchJSONData:function(b,a){a=a||"data/";request=new XMLHttpRequest();request.open("GET",a+b,false);request.send(null);return JSON.parse(request.responseText)},};