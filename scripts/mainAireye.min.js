window.addEventListener("load",function(){interfaceDisplay.setUtcClock("timeDisplay");interfaceDisplay.showHideHeader("headerControl");try{ae.drawMap();setInterval(function(){ae.drawAirplanes()},2000)}catch(a){console.log("The google maps object is not defined. "+a)}},false);window.addEventListener("resize",function(){var a=ae.getTrackerCoordinates();ae.gMap.setCenter({lat:a.latitude,lng:a.longitude})},false);var ae={gMap:null,airplanesMarkers:{},getTrackerCoordinates:function(){return gen.fetchJSONData("tracker.json")},getLocalAirports:function(){return gen.fetchJSONData("local-airports.json")},getMapOptions:function(a){return{backgroundColor:"#010101",center:new google.maps.LatLng(a.latitude,a.longitude),zoom:11,maxZoom:15,minZoom:8,mapTypeControl:false,streetViewControl:false,zoomControl:false,panControl:false,}},getAirplanesData:function(){var c=gen.fetchJSONData("getCorsJSON.php","functions/"),b={};for(var a=0;a<c.length;a+=1){if(c[a]["hex"]!=="undefined"){b[c[a]["hex"]]=c[a]}}return b},drawDistanceCircles:function(b,e,a){for(var c=10;c<=e*10;c+=10){var d=new google.maps.Circle({map:b,center:{lat:a.latitude,lng:a.longitude},radius:c*1852,fillOpacity:0,strokeWeight:1,strokeOpacity:0.2,strokeColor:"#2ECC71",})}},drawAirportHighlight:function(a,b){for(i in b){var c=new google.maps.Circle({map:a,center:{lat:b[i].lat,lng:b[i].lon},radius:b[i].size*1000,strokeColor:"#FFFFFF",strokeOpacity:0,strokeWeight:0,fillColor:"#27AF5F",fillOpacity:0.1,})}},drawMap:function(){var b=new google.maps.StyledMapType([{stylers:[{hue:"#22ff00"},{saturation:-62},{visibility:"simplified"},{invert_lightness:true},{lightness:-64}]},{featureType:"administrative",stylers:[{visibility:"simplified"},{color:"#333333"}]},{featureType:"poi",stylers:[{visibility:"off"}]},{featureType:"road",stylers:[{visibility:"on"},{lightness:-50}]},{featureType:"transit",stylers:[{visibility:"off"}]},{featureType:"transit.station.airport",elementType:"geometry",stylers:[{visibility:"on"},{invert_lightness:true},{weight:8},{color:"#27AE60"}]},{featureType:"water",stylers:[{visibility:"off"}]}],{name:"Aireye Styled Map"}),a="ae_styled_map",c=this.getLocalAirports(),d=this.getTrackerCoordinates();this.gMap=new google.maps.Map(document.getElementById("googleMap"),this.getMapOptions(d));this.gMap.mapTypes.set(a,b);this.gMap.setMapTypeId(a);this.drawDistanceCircles(this.gMap,20,d);this.drawAirportHighlight(this.gMap,c)},drawSingleAirplane:function(a){return new google.maps.Marker({position:new google.maps.LatLng(a.lat,a.lon),icon:{path:google.maps.SymbolPath.FORWARD_CLOSED_ARROW,scale:3,strokeColor:"#FFFFFF",rotation:a.track,},map:this.gMap,})},updateAirplanesMarkers:function(a){if(this.airplanesMarkers.hasOwnProperty(a.hex)){if(a.seen>30){this.removeStaleAirplaneMarker(this.airplanesMarkers[a.hex]);return true}else{this.airplanesMarkers[a.hex].setPosition(new google.maps.LatLng(a.lat,a.lon));this.airplanesMarkers[a.hex]["lastSeen"]=0;return true}}return false},removeStaleAirplaneMarker:function(a){a.setMap(null);delete a},drawAirplanes:function(){var b=this.getAirplanesData(),c=this.airplanesMarkers;airplaneDataValidator=function(d){if(d.validposition===0){return false}return true};if(Object.keys(this.airplanesMarkers).length<1){for(var a in b){if(airplaneDataValidator(b[a])){this.airplanesMarkers[a]=this.drawSingleAirplane(b[a])}}}else{for(var a in b){if(airplaneDataValidator(b[a])){if(!this.updateAirplanesMarkers(b[a])){this.airplanesMarkers[a]=this.drawSingleAirplane(b[a])}}}}}};var interfaceDisplay={setUtcClock:function(e,f){(f)?clearTimeout(f):null;var b=new Date(),d=b.getUTCHours(),a=b.getUTCMinutes(),c=b.getUTCSeconds();if(d<10){d="0"+d}if(a<10){a="0"+a}if(c<10){c="0"+c}document.getElementById(e).innerHTML=d+":"+a+"."+c;var f=setInterval(function(){interfaceDisplay.setUtcClock(e,f)},1000)},showHideHeader:function(a){var b=document.getElementById(a);b.addEventListener("click",function(){var c=this.childNodes[1].className;if(c.indexOf("open")>-1){document.getElementsByTagName("header")[0].style.marginLeft="100%";this.childNodes[1].className=c.replace(" open","")}else{document.getElementsByTagName("header")[0].style.marginLeft="0px";this.childNodes[1].className=c+" open"}})},};var gen={fetchJSONData:function(b,a){a=a||"data/";request=new XMLHttpRequest();request.open("GET",a+b,false);request.send(null);return JSON.parse(request.responseText)},};